function shuffle(n){for(var e,t,r=n.length;r;e=Math.floor(Math.random()*r),t=n[--r],n[r]=n[e],n[e]=t);return n}var w=550,h=520,r1=Math.min(w,h)/2-4,r0=r1-20,format=d3.format(",.3r"),provOrigin=[],destination=[],layout=d3.layout.chord().sortGroups(d3.descending).sortSubgroups(d3.descending).sortChords(d3.descending).padding(.04);colors=["#308C95","#F5E14D","#F59C4D","#653FA7","#AA3AA7","#00353A","#5F2D00","#190341","#4DE385","#38B265","#F56A4D","#F5CC4D"];var fill=d3.scale.ordinal().domain([0,1,2]).range(colors),arc=d3.svg.arc().innerRadius(r0).outerRadius(r1),chord=d3.svg.chord().radius(r0),svg=d3.select("section.origine").selectAll("div").data([provOrigin,destination]).enter().append("div").attr("class","sibling-1 animated bounceIn").style("display","inline-block").style("width",w+"px").style("height",h+"px").append("svg:svg").attr("width",w).attr("height",h).append("svg:g").attr("id","circle").attr("transform","translate("+w/2+","+h/2+")");d3.csv("https://gist.githubusercontent.com/guinslym/d81d1a7786a867b616c6/raw/8dd1ca4ddf34e01789d4326c4e1eab49e0fa2d50/interprovince.csv",function(n){function e(n,e){c.classed("fade",function(n){return n.source.index!=e&&n.target.index!=e})}function t(){les_diagrams=$(".sibling-1"),les_diagrams.first().appendTo(".origine"),les_diagrams.last().appendTo(".destination")}function r(n){return o[n]||(o[n]={name:n,id:s++})}function i(){return+this.total}var o={},d=[],s=0;n.forEach(function(n){n.provOrigin=r(n.provOrigin),n.destination=r(n.destination),n.destination.nbr_pourcentage=n.nbr_pourcentage,n.valueOf=i});for(var u=0;s>u;u++){provOrigin[u]=[],destination[u]=[];for(var l=0;s>l;l++)provOrigin[u][l]=0,destination[u][l]=0}n.forEach(function(n){provOrigin[n.provOrigin.id][n.destination.id]=n,destination[n.destination.id][n.provOrigin.id]=n,d[n.provOrigin.id]=n.provOrigin,d[n.destination.id]=n.destination}),svg.each(function(n,t){function r(n){return console.log(n),"AB"==n?"L'Alberta":"CB"==n?"la Colombie-britannique":"MB"==n?"le Manitoba":"NB"==n?"le Nouveau Brunswick":"NL"==n?"Terre-Neuve-et-Labrador":"NS"==n?"la Nouvelle-\xc9cosse":"NT"==n?"les T\xe9rritoires du Nord-Ouest":"NU"==n?"le Nunavut":"ON"==n?"l'Ontario":"PE"==n?"l'\xcele du Prince-\xc9duard":"QC"==n?"le Qu\xe9bec":"SK"==n?"la Saskatchewan":"le Yukon"}function i(n){return console.log(n),"AB"==n?"de l'Alberta":"CB"==n?"de la Colombie-britannique":"MB"==n?"du Manitoba":"NB"==n?"du Nouveau Brunswick":"NL"==n?"de Terre-Neuve-et-Labrador":"NS"==n?"de la Nouvelle-\xc9cosse":"NT"==n?"des T\xe9rritoires du Nord-Ouest":"NU"==n?"du Nunavut":"ON"==n?"de l'Ontario":"PE"==n?"de l'\xcele du Prince-\xc9duard":"QC"==n?"du Qu\xe9bec":"SK"==n?"de la Saskatchewan":"du Yukon"}var o=d3.select(this);layout.matrix(n);var s=["AB","CB","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YK"];o.selectAll("path.chord").data(layout.chords).enter().append("svg:path").attr("class","chord").style("fill",function(n){return fill(n.source.value.nbr_pourcentage)}).style("stroke",function(n){return d3.rgb(fill(n.source.value.nbr_pourcentage)).darker()}).attr("d",chord).append("svg:title");var u=o.selectAll("g.group").data(layout.groups).enter().append("svg:g").attr("class","group").on("mouseover",e),l="";u.append("svg:path").style("fill",function(n){return fill(d[n.index].nbr_pourcentage)}).attr("id",function(n,e){return"group"+n.index+"-"+t}).attr("d",arc).append("svg:title").text(function(n){return t?l="En 2013, "+r(d[n.index].name)+" a accueillie "+format(n.value)+" migrants":(a=s.indexOf(d[n.index].name),l=format(n.value)+" r\xe9sidents "+i(d[n.index].name)+" ont chang\xe9 \nde province de r\xe9sidence en 2013 ")}),u.append("svg:text").attr("x",6).attr("dy",15).filter(function(n){return n.value>110}).append("svg:textPath").attr("xlink:href",function(n){return"#group"+n.index+"-"+t}).text(function(n){return n.value<5e3?"":d[n.index].name})},t());var c=svg.selectAll("path.chord").on("mouseover",function(n){}).on("mouseout",function(n){console.log("\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n")})});